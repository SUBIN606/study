# 운영체제
운영체제(OS, Operating System)는 사용자가 컴퓨터를 쉽게 다루게 해주는 인터페이스다.

운영체제의 역할은 크게
1. CPU 스케줄링과 프로세스 관리: CPU 소유권 프로세스에게 할당, 프로세스 생성 및 삭제, 자원 할당 및 반환 관리
2. 메모리 관리: 한정된 메모리를 어떤 프로세스에 얼만큼 할당해야 하는지 관리
3. 디스크 파일 관리: 디스크 파일을 어떠한 방법으로 보관할지 관리
4. I/O 디바이스 관리: I/O 디바이스들인 마웃, 키보드와 컴퓨터 간에 데이터를 주고받는 것을 관리

가 있다.

### 시스템콜
운영체제가 커널에 접근하기 위한 인터페이스이며 유저 프로그램이 운영체제의 서비스를 받기 위해 커널 함수를 호출할 때 사용한다.

프로세스나 스레드에서 운영체제로 어떠한 요청을 할 때 시스템콜이라는 인터페이스와 커널을 거쳐 운영체제에 전달된다. 시스템 콜은 하나의 추상화 계층이며 이를 통해 네트워크 통신이나 데이터베이스와 같은 낮은 단계의 영역 처리에 대한 부분을 많이 신경 쓰지 않고 프로그램을 구현할 수 있다는 장점이 있다.

## CPU
CPU(Central Processing Unit)는 산술논리연산장치, 제어장치, 레지스터로 구성되어 있는 컴퓨터 장치를 말한다. 인터럽트에 의해 단순히 메모리에 존재하는 명령어를 해석해서 실행한다.

관리자역할을 하는 운영체제의 커널이 프로그램을 메모리에 올려 프로세스로 만들면 CPU가 이를 처리한다.

### 인터럽트
인터럽트는 어떤 신호가 들어왔을 때 CPU를 잠간 정지시키는 것을 말한다. 인터럽트가 발생되면 인터럽트 핸들러 함수가 모여 있는 인터럽트 벡터로 가서 인터럽트 핸들러 함수가 실행된다. 인터럽트 간에는 우선순위가 있으며 우선순위에 따라 실행되며 하드웨어 인터럽트, 소프트웨어 인터럽트 두 가지로 나뉜다.

### 메모리
메모리는 전자회로에서 데이터나 상태, 명령어 등을 기록하는 장치를 말하며 보통 RAM(Random Access Memory)을 일컬어 메모리라고도 한다. CPU는 계산을 담당하고, 메모리는 기억을 담당한다.

공장에 비유하자면 CPU는 일꾼이고, 메모리는 작업장이며, 작업장의 크기가 곧 메모리의 크기다. 즉, 메모리가 크면 클수록 많은 일을 동시에 할 수 있다.

## 캐시
캐시(cache)는 데이터를 미리 복사해 놓는 임시 저장소이자 빠른 장치와 느린 장치에서 속도 차이에 따른 병목 현상을 줄이기 위한 메모리를 말한다.

메모리와 CPU 사이의 속도 차이를 해결하기 위해 중간에 레지스터 계층을 두어 속도 차이를 해결한다. 이렇게 속도 차이를 해결하기 위해 계층과 계층 사이에 있는 계층을 캐싱 계층이라 한다.

### 지역성
캐시를 직접 설정할 때는 자주 사용하는 데이터를 기반으로 설정해야 한다. 자주 사용하는 데이터에 대한 근거가 되는 것이 바로 지역성이다. 지역성은 시간 지역성과 공간 지역성으로 나뉜다.

- 시간 지역성: 최근 사용한 데이터에 다시 접근하려는 특성
- 공간 지역성: 최근 접근한 데이터를 이루고 있는 공간이나 그 가까운 공간에 접근하려는 특성

### 웹 브라우저의 캐시
소프트웨어적인 대표적인 캐시로는 웹 브라우저의 쿠키, 로컬 스토리지, 세션 스토리지가 있다. 이러한 것들은 보통 사용자의 정보나 인증 모듈 관련 사항들을 웹 브라우저에 저장해 추후 서버에 요청할 때 자신을 나타내는 아이덴티티나 중복 요청 방지를 위해 쓰인다.

# 프로세스와 스레드
프로세스는 컴퓨터에서 실행되고 있는 프로그램을 말하며 CPU 스케줄링의 대상이 되는 작업이라는 용어와 거의 같은 의미로 쓰인다. 스레드는 프로세스 내 작업의 흐름을 지칭한다.

프로그램이 메모리에 올라가면 프로세스가 되는 인스턴스화가 일어나고, 이후 운영체제의 CPU 스케줄러에 따라 CPU가 프로세스를 실행한다.

### 컴파일
프로그램은 컴파일러가 컴파일 과정을 거쳐 컴퓨터가 이해할 수 있는 기계어로 번역되어 실행될 수 있는 파일이다.

## 프로세스의 메모리 구조
스택, 힙, 데이터 영역, 코드 영역으로 나눠진다. 스택은 위 주소부터 할당되고 힙은 아래 주소부터 할당된다.

### 스택
스택에는 지역변수, 매개변수, 함수가 저장되고 컴파일 시에 크기가 결정되며 동적인 특징을 갖는다.
### 힙
힙은 동적 할당할 때 사용되며 런타임 시 크기가 결정된다. 힙은 동적인 특징을 가진다.
### 데이터 영역
데이터 영역에는 전역변수, 정적변수가 저장되고 정적인 특징을 갖는 프로그램이 종료되면 사라지는 변수가 들어있는 영역이다.

데이터 영역은 BSS 영역과 Data 영역으로 나뉘고, BSS 영역은 초기화 되지 않은 변수가 0으로 초기화되어 저장되며, Data 영역은 0이 아닌 다른 값으로 할당된 변수들이 저장된다.
### 코드영역
코드 영역은 프로그램에 내장되어 있는 소스 코드가 들어가는 영역이다. 이 영역은 수정 불가능한 기계어로 저장되어 있으며 정적인 특징을 갖는다.

## PCB(Process Control Block)
PCB는 운영체제에서 프로세스에 대한 메타데이터를 저장한 데이터를 말한다. 프로세스 제어 블록이라고도 한다. 프로세스가 생성되면 운영체제는 해당 PCB를 생성한다.

프로그램이 실행되면 프로세스가 생성되고, 프로세스 주소 값들에 스택, 힙 등의 구조를 기반으로 메모리가 할당된다. 그리고 이 프로세스의 메타데이터들이 PCB에 저장되어 관리된다.

PCB는 다음과 같은 정보로 이루어져 있다.

- 프로세스 스케줄링 상태
- 프로세스 ID
- 프로세스 권한
- 프로세스 카운터
- CPU 레지스터
- CPU 스케줄링 정보
- 계정 정보
- I/O 상태 정보

## 컨텍스트 스위칭(context switching)
컨텍스트 스위칭이란 PCB를 교환하는 과정을 말한다. 한 프로세스에 할당된 시간이 끝나거나 인터럽트에 의해 발생한다.

컴퓨터는 많은 프로그램을 동시에 실행하는 것처럼 보이지만 어떠한 시점에서 실행되고 있는 프로세스는 단 한 개이며, 많은 프로세스가 동시에 구동되는 것처럼 보이는 것은 다른 프로세스와의 컨텍스트 스위칭이 아주 빠른 속도로 실행되기 때문이다.
> 사실 현대의 컴퓨터는 멀티코어의 CPU를 가지므로 한 시점에 한 개의 프로그램이라는 설명은 틀린 것이다.

컨텍스트 스위칭이 일어날때 마다 유휴 시간(idle time)이 발생한다. 또한 컨텍스트 스위칭에 캐시 클리어 과정을 겪게 되고, 이 때문에 캐시미스가 발생해 비용이 더 든다.

스레드에서도 컨텍스트 스위칭은 일어나지만, 스레드는 스택 영역을 제외한 모든 메모리를 공유하므로 스레드 컨텍스트 스위칭 비용이 더 적고 시간도 더 적게 걸린다.

## 멀티프로세싱
멀티프로세싱은 여러 개의 프로세스, 즉 멀티프로세스를 통해 동시에 두 가지 이상의 일을 수행할 수 있는 것을 말한다. 이를 통해 하나 이상의 일을 병렬로 처리할 수 있으며 특정 프로세스의 메모리, 프로세스 중 일부에 문제가 발생되더라도 다른 프로세스를 이용해서 처리할 수 있으므로 신뢰성이 높다.

### IPC(Inter Process Communication)
멀티프로세스는 IPC가 가능하며 IPC는 프로세스끼리 데이터를 주고받고 공유 데이터를 관리하는 메커니즘을 뜻한다.

IPC의 종류로는 공유 메모리, 파일, 소켓, 익명 파이프, 명명 파이프, 메시지 큐가 있다. 메모리가 완전히 공유되는 스레드보다는 속도가 떨어진다.

## 스레드
스레드는 프로세스의 실행 가능한 가장 작은 단위이다. 프로세스는 여러 스레드를 가질 수 있다. 스레드는 코드, 데이터, 힙을 서로 공유한다.

### 멀티스레딩
멀티스레딩은 프로세스 내 작업을 여러 개의 스레드, 멀티스레드로 처리하는 기법이다. 스레드끼리 서로 자원을 공유하기 때문에 효율성이 높다.

### 공유자원
공유자원은 시스템 안에서 각 프로세스, 스레드가 함께 접근할 수 있는 모니터, 프린터, 메모리, 파일, 데이터 등의 자원이나 변수 등을 의미한다. 이 공유 자원을 두 개 이상의 프로세스가 동시에 읽거나 쓰는 상황을 경쟁 상태라고 한다.

### 임계 영역
임계 영역은 둘 이상의 프로세스, 스레드가 공유 자원에 접근할 때 순서 등의 이유로 결과가 달라지는 코드 영역을 말한다. 임계 영역을 해결하기 위한 방법은 크게 뮤텍스, 세마포어, 모니터 세 가지가 있으며 이 방법 모두 상호 배제, 한정 대기, 융통성이란 조건을 만족한다.

- 뮤텍스: 프로세스나 스레드가 공유 자원을 잠금 설정하고 사용한 후에는 잠금 해제하는 객체
- 세마포어: 일반화된 뮤텍스로 간단한 정수 값과 두 가지 함수 wait 및 signal로 공유 자원에 대한 접근을 처리
- 모니터: 둘 이상의 스레드나 프로세스가 공유 자원에 안전하게 접근할 수 있도록 공유 자원을 숨기고 해당 접근에 대한 인터페이스만 제공

### 교착상태
교착 상태는 두 개 이상의 프로세스들이 서로가 가진 자원을 기다리며 중단된 상태를 말한다.

- 상호 배제: 한 프로세스가 자원을 독점하고 있어 다른 프로세스가 접근 불가
- 점유 대기: 특정 프로세스가 점유한 자원을 다른 프로세스가 요청하는 상태
- 비선점: 다른 프로세스의 자원을 강제적으로 가져올 수 없음
- 환형 대기: 서로가 서로의 자원을 요구하는 상황
